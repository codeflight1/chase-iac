<!DOCTYPE html>
<style>
  body {
    margin: 0px;
  }

  .pointCont, .pointOuter {
    border-radius: 50%;
  }

  .pointCont {
    display: block;
    box-sizing: border-box;
    width: 30px;
    height: 30px;
    background: hsla(0,0%,100%,.5);
    position: absolute;
    cursor: pointer;
    z-index: 20;
    margin-left: -15px;
    margin-top: -15px;
  }

  .pointOuter {
    width: 100%;
    height: 100%;
    box-shadow: 0 0 5px 0 rgba(0,0,0,.1);
  }

  .pointInner {
    width: 20px;
    height: 20px;
    background: hsla(0,0%,100%,.5);
    margin-left: -10px;
    margin-top: -10px;
    position: absolute;
    left: 50%;
    top: 50%;
    border-radius: 50%;
  }

  .contentCont {
    background-color: #fefefe;
    margin-left: 4%;
    min-height: 100px;
    position: absolute;
    width: 30%;
    z-index: 100;
    box-shadow: 0 0 5px 0 rgba(0,0,0,.3);
    min-width: 220px;
    max-width: 350px;
    animation-duration: .5s;
    animation-fill-mode: both;
    display: none;
  }

  .inup {
    animation-name: inup;
    display: block;
  }

  @keyframes inup {
    0% {
      opacity: 0;
      transform: translate3d(0,100%,0);
    }

    100% {
      opacity: 1;
      transform: none;
    }
  }

  .text {
    padding: 24px;
    padding-top: 15px;
    padding-bottom: 24px;
    display: block !important;
  }

  .title {
    font-size: 18px;
    margin-bottom: 14px;
    width: 100%;
  }

  .content {
    width: 100%;
    font-size: 11px;
    line-height: 18px;
    color: #8e8f8f;
  }

  .arrow {
    color: #fefefe !important;
    top: 10px;
    position: absolute;
    left: -17px;
    z-index: -1;
    line-height: 0;
  }

  .left {
    margin-left: 233px;
  }

  img {
    height: 100%;
    display: block;
    max-width: 100vw;
    max-height: 100vh;
  }

  #blocks {
    display: inline;
    position: relative;
  }

  #holder {
    position: absolute;
    top: 0px;
    left: 0px;
  }

</style>
<div id="blocks">
  <div id="wrapper" style="display: initial"><img src="CHASE-Copy-of-Page-6.png"></img></div>

  <svg class="left" width="20" style="width: 20px !important; height: 53px !important; display: block;" height="53" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512">
    <path fill="#ffffff" d="M0 384.662V127.338c0-17.818 21.543-26.741 34.142-14.142l128.662 128.662c7.81 7.81 7.81 20.474 0 28.284L34.142 398.804C21.543 411.404 0 402.48 0 384.662z"></path>
  </svg>

  <svg class="right" width="20" style="width: 20px !important; height: 53px !important; display: block;" height="53" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 512">
    <path fill="#ffffff" d="M192 127.338v257.324c0 17.818-21.543 26.741-34.142 14.142L29.196 270.142c-7.81-7.81-7.81-20.474 0-28.284l128.662-128.662c12.599-12.6 34.142-3.676 34.142 14.142z"></path>
  </svg>

  <div class="pointCont" onclick="pointEvent(this, event)">
    <div class="pointOuter">
      <div class="pointInner"></div>
    </div>
  </div>

  <div class="contentCont" onclick="event.stopPropagation()">
    <div class="arrow"></div>
    <div class="text">
      <div class="title"></div>
      <div class="content"></div>
    </div>
  </div>

  <div id="holder">
  </div>
</div>

<script>
  function update(event) {
    document.getElementById("holder").style.width = document.getElementById("wrapper").offsetWidth + "px"
    document.getElementById("holder").style.height = document.getElementById("wrapper").offsetHeight + "px"
    document.querySelector("body").style.marginLeft = ((Math.max(document.documentElement.clientWidth || 0, window.innerWidth || 0) - document.getElementById("wrapper").offsetWidth) / 2) + "px"
  }

  window.addEventListener('resize', update, true);
  window.addEventListener('load', update, true);

  document.onclick = function () {
    for (i of Object.keys(a)) {
      if (a[i].status === true) {
        document.getElementById(i + "-content").classList.remove("inup")
        a[i].status = false
      }
    }
  }

  function pointEvent(item, event) {
    var name = item.id.slice(0, -6)
    var node = document.getElementById(name + "-content")
    if (a[name].status === false) {
      node.classList.add("inup")
      a[name].status = true
    }
    event.stopPropagation()
  }

  var a = {
    mram: {
      x: 29,
      y: 25,
      title: "Magnetoresistive RAM (MRAM)",
      content: "MRAM is used for non-volatile program storage.<br>MRAM stores data in magnetic tunnel junctions, making it more reliable and less susceptible to SEUs.",
      dir: [true, false]
    },
    ddr: {
      x: 45,
      y: 10,
      title: "LPPDR4",
      content: "LPDDR4 is the low-power version of the common DDR4 standard, and is used for volatile storage. The SoC's memory controller supports ECC, which reduces the risk of SEUs.",
      dir: [true, false]
    },
    soc: {
      x: 65.1,
      y: 24.8,
      title: "AM6548 SoC",
      content: "The SoC is the most important part, and we selected the Texas Instruments AM6548, a processor designed for industrial control applications. It was chosen for its inclusion of real-time cores, application cores, programmable real-time units, and extensive use of ECC on internal memories. The programmable real-time units each contain two processing cores, two real-time cores, two gigabit Ethernet interfaces, and a variety of IO options. These are of special interest for CHASE, because one can be dedicated to verifying and synchronizing systems between the three processors, offloading that work from the main processors.",
      dir: [false, false]
    },
    psu: {
      x: 8.1,
      y: 40,
      title: "Dual-redundant PSU",
      content: "The dual-redundant power supply unit (PSU) regulates a 28V supply down to the levels required by the SoC and its subsystems.",
      dir: [true, false]
    },
    io: {
      x: 73.3,
      y: 95.0,
      title: "IO Interface board",
        content: "The processing PCB is designed to connect to a mission-specific interface board. The processing PCB provides power, and passes through the following interfaces from each processor:<ul><li>RGMII Gigabit Ethernet (2)</li><li>CAN (2)</li><li>high-speed SerDes (2)</li><li>GPIO</li>",
      dir: [false, true]
    },
    flash: {
      x: 81.4,
      y: 41.3,
      title: "Flash mass storage",
      content: "Commercial flash storage is used for mass storage of mission or scientific data. Flash storage is more sensitive to radiation, but alternatives such as MRAM are simply not available in the required densities. OCHRES uses the ZFS filesystem which can detect and correct errors, similar to the use of ECC on volatile memories.",
      dir: [false, false]
    }
  };

	for (j of Object.keys(a)) {
    var node = document.getElementsByClassName("pointCont")[0].cloneNode(true);
    node.id = j + "-point";
    i = a[j]
    node.style.left = i.x + '%';
    node.style.top = i.y + '%';
    document.getElementById("holder").appendChild(node);

    node = document.getElementsByClassName("contentCont")[0].cloneNode(true);
    node.id = j + "-content";
    node.style.left = "calc(" + i.x + "% + " + (i.dir[0] ? 35 : -255) + "px";
    node.getElementsByClassName("title")[0].innerHTML = i.title;
    node.getElementsByClassName("content")[0].innerHTML = i.content;
    node.getElementsByClassName("arrow")[0].appendChild(document.getElementsByClassName(i.dir[0] ? "right" : "left")[0].cloneNode(true))
    document.getElementById("holder").appendChild(node);

    node.visibility = "hidden"
    node.style.display = "block"
    var height = node.offsetHeight
    node.style.display = ""
    node.visibility = ""
    node.style.top = "calc(" + i.y + "% - " + (i.dir[1] ? (height - 36.5) : 36.5) + "px)";
    if (i.dir[1]) {
      node.getElementsByClassName("arrow")[0].style.marginTop = (height - 73) + "px"
    }

    i["status"] = false
	}

  document.getElementsByClassName("pointCont")[0].remove();
  document.getElementsByClassName("contentCont")[0].remove();
  document.getElementsByClassName("left")[0].remove();
  document.getElementsByClassName("right")[0].remove();
</script>
